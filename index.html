<!DOCTYPE html>
<?php
#1. Start session
session_start();
#2. check session

#3. connect to Database
include_once './DBConnect.php';

#4. Execute query
$query = "select * from Book";
$rs = mysqli_query($conn, $query);
$count = mysqli_num_rows($rs);

if (isset($_GET['btnSearch'])):
    $search = $_GET['txtSearch'];
    $query = "select * from Book where Title like '%{$search}%'";
    $rs = mysqli_query($conn, $query);
    $count = mysqli_num_rows($rs);
endif;
?>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css">
        <title>Book List</title>
    </head>
    <body class="container">
        <div>
            <h1 style="color:red">Book List</h1>
        <div style="padding: 20px 0px; text-align:left">
            <a href="Create.php">Create New Book</a>
        </div>
        <div id="pnSearch" align="right">
            <form align="center">
                <td>Book Title:</td>
                <input name="txtSearch" placeholder="Search here..." size="50" >
                <input type="submit" name="btnSearch" value="Filter">
            </form>
        </div>
        
        </div>
        <table class="table table-bordered table-hover">
            <tr>
                <th>ISBN</th>
                <th>Title</th>
                <th>Author</th>
                <th>Edition</th>
                <th>Function</th>

            </tr>
            <?php
            if ($count == 0):
                echo 'Record not found!';
            else:
                while ($fields = mysqli_fetch_array($rs)):
                    ?>
                    <tr>
                        <td><?= $fields[0] ?></td>
                        <td><?= $fields[1] ?></td>
                        <td><?= $fields[2] ?></td> 
                        <td><?= $fields[3] ?></td>
                        <td>
                            <a href="Details.php?isbn=<?= $fields[0] ?>">Details</a>
                        </td>
                    </tr>
                    <?php
                endwhile;
            endif;
            ?>
        </table>
    </body>
</html>
